{% extends "base.html" %}

{% block title %}使用{% endblock %}

{% block head %}
  <h1>欢迎使用城院师生教学交互系统</h1>
  <p class="lead">Dozens of reusable components are built into Bootstrap to provide navigation, alerts, popovers, and much more.</p>
  <div class="subnav">
    <ul class="nav nav-pills">
      <li>
	<a><strong>按条件排序:</strong></a>
      </li>
      <li class="dropdown">
	<a class="dropdown-toggle" href="#" data-toggle="dropdown">
	  Navigation
	  <b class="caret"></b>
	</a>

	<ul class="dropdown-menu">
	  <li class="">
	    <a href="#navs">Nav, tabs, pills</a>
	  </li>
	  <li class="">
	    <a href="#navbar">Navbar</a>
	  </li>
	  <li class="">
	    <a href="#breadcrumbs">Breadcrumbs</a>
	  </li>
	  <li class="">
	    <a href="#pagination">Pagination</a>
	  </li>
	</ul>
      </li>
      <li>
	<a href="?query=name">名字排序</a>
      </li>
      <li>
	<a href="{{ courseid }}">学号排序</a>
      </li>
      <li>
	<a href="#labels">Labels</a>
      </li>
    </ul>
  </div>
  <div class="subnav">
    <ul class="nav nav-pills">
      <li>
	<a><strong>按条件点名:</strong></a>
      </li>
      <li class="dropdown">
	<a class="dropdown-toggle" href="#" data-toggle="dropdown">
	  随机选取
	  <b class="caret"></b>
	</a>

	<ul class="dropdown-menu">
	  <li class="">
	    <a href="#navs">1人</a>
	  </li>
	  <li class="">
	    <a href="#navbar">2人</a>
	  </li>
	  <li class="">
	    <a href="#breadcrumbs">3人</a>
	  </li>
	  <li class="">
	    <a href="#pagination">4人</a>
	  </li>
	</ul>
      </li>
    </ul>
  </div>

  <section id="blank-line"></section>
{% endblock %}

{% block content %}
  
  <div>
    <p class="lead">{{ coursename }} 课程共有 {{ amount }} 人。</p>
    {% for appra in appraisals %}
      <div class="span3">
	<div class="hero-unit">
	  <p>
	    <span class="label">姓名：</span>
	    {{ appra.stu_name }}
	  </p>
	  <p>
	    <span class="label">学号：</span>
	    {{ appra.stu_id }}
	  </p>
	  <p>
	    <span class="label">评价次数：</span>
	    {{ appra.appr_counter }}
	  </p>
	  <p>
	    <span class="label">上一次评价：</span>
	    {% if appra.last_appr == "excellence" %}
	      优秀
	    {% endif %}
	    {% if appra.last_appr == "good" %}
	      良好
	    {% endif %}
	    {% if appra.last_appr == "bad" %}
	      一般
	    {% endif %}
	    {% if appra.last_appr == "absent" %}
	      旷课
	    {% endif %}
	    {% if appra.last_appr == "leave" %}
	      请假
	    {% endif %}
	    {% if appra.last_appr == "come_late" %}
	      迟到
	    {% endif %}
	    {% if not appra.last_appr %}
	      无
	    {% endif %}
	  </p>
	  <p>
	    <div id="appraise{{ appra.stu_id }}" class="modal hide fade" style="display: none;">
	      <div class="modal-header">
		<button class="close" data-dismiss="modal">×</button>
		<h3>对 {{ appra.stu_name }} 进行点评</h3>
	      </div>
	      <div class="modal-body">
		<form class="form-horizontal" action="../appraisal-poll/{{ appra.slug }}" method="post" enctype="multipart/form-data">
		  {% csrf_token %}
		  <fieldset>
		    <div class="control-group">
		      <label class="control-label">简单评价</label>
		      <div class="controls">
			<label class="radio">
			  <input id="optionsRadios1" type="radio" checked="" value="excellence" name="appraisal">
			  优秀
			</label>
			<label class="radio">
			  <input id="optionsRadios2" type="radio" value="good" name="appraisal">
			  良好
			</label>
			<label class="radio">
			  <input id="optionsRadios3" type="radio" value="bad" name="appraisal">
			  一般
			</label>
			<label class="radio">
			  <input id="optionsRadios3" type="radio" value="absent" name="appraisal">
			  旷课
			</label>
			<label class="radio">
			  <input id="optionsRadios3" type="radio" value="leave" name="appraisal">
			  请假
			</label>
			<label class="radio">
			  <input id="optionsRadios3" type="radio" value="come_late" name="appraisal">
			  迟到
			</label>
		      </div>
		    </div>
		    <div class="control-group">
		      <label class="control-label" for="textarea">评论</label>
		      <div class="controls">
			<input name="comment" id="textarea" class="input-xlarge" type="text">
		      </div>
		    </div>
		    <div class="form-actions">
		      <button class="btn btn-primary" type="submit">提交评论</button>
		      <a class="btn" data-dismiss="modal" href="#">取消</a>
		    </div>
		  </fieldset>
		</form>
	      </div>
	    </div>
	    <a class="btn btn-primary" href="#appraise{{ appra.stu_id }}" data-toggle="modal">
	      进行点评
	    </a>
	  </p>

	  <p>
	    <div id="lookup-comments{{ appra.stu_id }}" class="modal hide fade" style="display: none;">
	      <div class="modal-header">
		<button class="close" data-dismiss="modal">×</button>
		<h3>{{ appra.stu_name }} 过往评价</h3>
	      </div>
	      <div class="modal-body">
		<h4>评价汇总：</h4>
		<p>Aenean lacinia bibendum nulla sed consectetur. Praesent commodo cursus magna, vel scelerisque nisl consectetur et. Donec sed odio dui. Donec ullamcorper nulla non metus auctor fringilla.</p>
		{% if appra.comments %}
  		  <h4>过往评论：</h4> 
		  {% for comment in appra.comments %}
		    <div class="legend-unit">
		      <p>{{ comment.comment }}</p>
		      <span class="label">评价于：</span>{{ comment.datetime }}
		    </div>
		  {% endfor %}
		{% else %}
		  <div class="legend-unit">
		    <p><h4>暂时还没有对该同学的评论。</h4></p>
		  </div>
		{% endif %}
	      </div>
	      <div class="modal-footer">
		<a class="btn" data-dismiss="modal" href="#">关闭</a>
	      </div>
	    </div>
	    <a class="btn btn-info" href="#lookup-comments{{ appra.stu_id }}" data-toggle="modal">
	      查看过往评价
	    </a>
	  </p>
	</div>
      </div>
    {% endfor %}
  </div>

{% endblock %}    
